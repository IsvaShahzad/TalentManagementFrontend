// Mobile Responsive Styles
// Breakpoints: xs (<576px), sm (≥576px), md (≥768px), lg (≥992px), xl (≥1200px)

// Global mobile adjustments
@media (max-width: 767.98px) {
  // Reduce padding on containers - but allow charts to spread
  .container-fluid,
  .container {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    max-width: 100vw;
    overflow-x: visible;
  }
  
  // Allow chart containers to break out if needed
  .chart-row {
    margin-left: -0.5rem !important;
    margin-right: -0.5rem !important;
    width: calc(100% + 1rem) !important;
    max-width: 100vw !important;
  }

  // Header adjustments
  .compact-header {
    padding: 0.5rem 0.75rem !important;
    
    .header-container {
      display: flex !important;
      flex-wrap: nowrap !important;
      align-items: center !important;
      justify-content: space-between !important;
      gap: 0.5rem !important;
    }
    
    .header-left {
      flex-shrink: 0 !important;
      min-width: auto !important;
    }
    
    .header-right {
      display: flex !important;
      align-items: center !important;
      gap: 0.25rem !important;
      flex-shrink: 0 !important;
      margin-left: auto !important;
    }
    
    .header-toggler {
      padding: 0.25rem !important;
      margin-right: 0.5rem;
      flex-shrink: 0 !important;
    }
    
    // Notifications and actions in header
    .header-notifications,
    .header-actions {
      display: flex !important;
      align-items: center !important;
      gap: 0.25rem !important;
      flex-shrink: 0 !important;
      
      .nav-item {
        margin: 0 !important;
        padding: 0 !important;
      }
    }
    
    // Hide dividers on mobile
    .navbar-divider {
      display: none !important;
    }
    
    // Avatar dropdown
    .header-actions .dropdown {
      flex-shrink: 0 !important;
    }
    
    // Theme dropdown
    .header-theme-dropdown {
      flex-shrink: 0 !important;
    }
    
    // Ensure icons don't wrap
    .header-nav {
      flex-wrap: nowrap !important;
      align-items: center !important;
      
      .nav-item {
        flex-shrink: 0 !important;
        margin: 0 !important;
      }
    }
  }

  // Sidebar should overlay on mobile
  .sidebar {
    z-index: 1030;
  }
  
  // Ensure wrapper doesn't get pushed by sidebar on mobile
  .wrapper {
    margin-left: 0 !important;
  }

  // Tables - make scrollable and expand horizontally
  .table-scroll {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    max-width: 100vw;
    margin-left: -0.5rem;
    margin-right: -0.5rem;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    position: relative;
    width: calc(100% + 1rem);
    
    // Add scroll indicator
    &::after {
      content: '← Scroll →';
      position: absolute;
      bottom: 0.5rem;
      right: 0.5rem;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.65rem;
      pointer-events: none;
      opacity: 0.7;
    }
  }

  // All tables - expand horizontally with more space
  .table,
  table {
    font-size: 0.75rem !important;
    min-width: 1400px !important; // Increased from 1200px for more horizontal space
    width: max-content !important; // Allow table to expand beyond container
    
    th, td {
      padding: 0.5rem 0.6rem !important; // Increased padding for more space
      white-space: nowrap;
      font-size: inherit;
      min-width: 120px !important; // Minimum width per column
    }
    
    // Header cells get more space
    th {
      min-width: 140px !important;
      padding: 0.6rem 0.7rem !important;
    }
    
    // Make action buttons smaller but still usable
    .btn {
      padding: 0.25rem 0.5rem;
      font-size: 0.7rem;
      width: auto;
      margin-bottom: 0;
    }
  }
  
  // Flexbox-based tables (like DisplayUsersTable)
  .users-table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    max-width: 100vw;
    margin-left: -0.5rem;
    margin-right: -0.5rem;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    width: calc(100% + 1rem);
  }
  
  .users-table-header,
  .users-table-row {
    min-width: 800px !important;
    width: max-content !important;
    
    > div {
      min-width: 120px !important;
      white-space: nowrap;
    }
  }
  
  // Other flexbox tables
  .d-flex.flex-wrap,
  div[style*="flex"] {
    // User table header and rows
    &[style*="flex-wrap"] {
      min-width: 100% !important;
      overflow-x: auto !important;
      -webkit-overflow-scrolling: touch;
      
      > div {
        min-width: 120px !important;
        flex: 1 1 auto !important;
        padding: 0.5rem 0.75rem !important;
      }
    }
  }
  
  // Container with table - allow horizontal scroll
  div[style*="border"][style*="borderRadius"]:not(.users-table-container) {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    max-width: 100vw;
    margin-left: -0.5rem;
    margin-right: -0.5rem;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
    width: calc(100% + 1rem);
  }
  
  // CContainer with tables
  .container,
  .container-fluid {
    overflow-x: visible !important;
    
    > div[style*="border"] {
      overflow-x: auto !important;
    }
  }

  // Forms - stack vertically
  .row {
    margin-left: 0;
    margin-right: 0;
    
    > [class*="col-"] {
      padding-left: 0.5rem;
      padding-right: 0.5rem;
      margin-bottom: 1rem;
    }
  }

  // Buttons - full width on mobile (except inline buttons)
  .btn:not(.btn-link):not(.btn-ghost) {
    width: 100%;
    margin-bottom: 0.5rem;
    
    &.btn-sm {
      font-size: 0.8rem;
      padding: 0.4rem 0.8rem;
    }
    
    // Allow buttons in button groups to be smaller
    .btn-group & {
      width: auto;
      margin-bottom: 0;
    }
  }
  
  // Button groups stack vertically on mobile
  .btn-group {
    flex-direction: column;
    width: 100%;
    
    .btn {
      width: 100%;
      border-radius: 0.375rem !important;
      margin-bottom: 0.25rem;
      
      &:first-child {
        border-top-left-radius: 0.375rem !important;
        border-top-right-radius: 0.375rem !important;
        border-bottom-left-radius: 0 !important;
        border-bottom-right-radius: 0 !important;
      }
      
      &:last-child {
        border-top-left-radius: 0 !important;
        border-top-right-radius: 0 !important;
        border-bottom-left-radius: 0.375rem !important;
        border-bottom-right-radius: 0.375rem !important;
        margin-bottom: 0;
      }
    }
  }

  // Modals - full screen on mobile (CoreUI)
  .modal {
    .modal-dialog {
      margin: 0;
      max-width: 100%;
      height: 100vh;
      max-height: 100vh;
    }
    
    .modal-content {
      border-radius: 0;
      height: 100vh;
      max-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    .modal-header {
      flex-shrink: 0;
      padding: 1rem;
    }
    
    .modal-body {
      overflow-y: auto;
      flex: 1;
      padding: 1rem;
      -webkit-overflow-scrolling: touch;
    }
    
    .modal-footer {
      flex-shrink: 0;
      padding: 0.75rem 1rem;
      flex-direction: column;
      
      .btn {
        width: 100%;
        margin-bottom: 0.5rem;
        
        &:last-child {
          margin-bottom: 0;
        }
      }
    }
  }

  // Cards - remove padding on mobile
  .card {
    margin-bottom: 1rem;
    border-radius: 0.5rem;
    
    .card-header {
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
    }
    
    .card-body {
      padding: 1rem;
    }
    
    .card-footer {
      padding: 0.75rem 1rem;
    }
  }
  
  // Form controls
  .form-control,
  .form-select {
    font-size: 16px; // Prevents zoom on iOS
    padding: 0.5rem 0.75rem;
  }
  
  // Labels
  .form-label {
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  // Search bars and filters
  .search-bar,
  .filter-bar {
    flex-direction: column;
    
    > * {
      width: 100%;
      margin-bottom: 0.5rem;
    }
  }

  // Dropdowns - ensure they fit
  .dropdown-menu {
    max-width: calc(100vw - 2rem);
    left: 1rem !important;
    right: 1rem !important;
    transform: none !important;
  }

  // Badges and tags
  .badge {
    font-size: 0.7rem;
    padding: 0.25rem 0.5rem;
  }

  // Text adjustments
  h1 { font-size: 1.5rem; }
  h2 { font-size: 1.3rem; }
  h3 { font-size: 1.1rem; }
  h4 { font-size: 1rem; }
  h5 { font-size: 0.9rem; }
  h6 { font-size: 0.85rem; }

  // Input groups
  .input-group {
    flex-direction: column;
    
    .input-group-text {
      border-radius: 0.375rem 0.375rem 0 0;
      width: 100%;
    }
    
    .form-control {
      border-radius: 0 0 0.375rem 0.375rem;
    }
  }

  // Alerts
  .alert {
    font-size: 0.85rem;
    padding: 0.75rem;
  }

  // Navigation
  .nav {
    flex-direction: column;
    
    .nav-item {
      width: 100%;
      margin-bottom: 0.25rem;
    }
  }
  
  // Charts - make larger on mobile
  .jobs-overview-card,
  .weekly-postings-card {
    height: auto !important;
    min-height: 500px !important;
    margin-bottom: 1.5rem !important;
    display: block !important;
    visibility: visible !important;
  }
  
  // Ensure card body is visible
  .jobs-overview-card .card-body,
  .weekly-postings-card .card-body {
    height: auto !important;
    min-height: 450px !important;
    display: flex !important;
    flex-direction: column !important;
  }
  
  // Chart row spacing
  .chart-row.align-items-stretch {
    margin-top: 1.5rem !important;
    display: flex !important;
    visibility: visible !important;
    
    > [class*="col-"] {
      margin-bottom: 1rem;
      display: block !important;
      visibility: visible !important;
    }
  }
  
  // Jobs Overview Chart Container
  .jobs-overview-chart {
    height: 400px !important;
    min-height: 400px !important;
    max-height: none !important;
    width: 100% !important;
    display: block !important;
    visibility: visible !important;
    position: relative !important;
    opacity: 1 !important;
    overflow: visible !important;
    flex: none !important; // Override flex: 1 to prevent collapse
  }
  
  // Weekly Postings Chart Container
  .weekly-postings-chart {
    height: 400px !important;
    min-height: 400px !important;
    max-height: none !important;
    width: 100% !important;
    display: block !important;
    visibility: visible !important;
    position: relative !important;
    opacity: 1 !important;
    overflow: visible !important;
    flex: none !important; // Override flex: 1 to prevent collapse
  }
  
  // Chart containers - ensure minimum size and full width
  .recharts-wrapper {
    min-height: 400px !important;
    height: 100% !important;
    width: 100% !important;
    min-width: 100% !important;
    display: block !important;
    visibility: visible !important;
    overflow: visible !important;
  }
  
  // ResponsiveContainer adjustments - CRITICAL for mobile - full width
  .recharts-responsive-container {
    min-height: 400px !important;
    height: 100% !important;
    width: 100% !important;
    min-width: 100% !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    position: relative !important;
    overflow: visible !important;
  }
  
  // Ensure ResponsiveContainer inside chart containers - FORCE dimensions and full width
  .jobs-overview-chart .recharts-responsive-container,
  .weekly-postings-chart .recharts-responsive-container {
    width: 100% !important;
    min-width: 100% !important;
    height: 100% !important;
    min-height: 400px !important;
    max-height: none !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    position: relative !important;
    overflow: visible !important;
  }
  
  // Force ResponsiveContainer to render on mobile with full width
  .jobs-overview-chart > div,
  .weekly-postings-chart > div {
    width: 100% !important;
    min-width: 100% !important;
    height: 100% !important;
    min-height: 400px !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    overflow: visible !important;
  }
  
  // Ensure chart surfaces are visible and full width
  .recharts-surface {
    display: block !important;
    visibility: visible !important;
    width: 100% !important;
    min-width: 100% !important;
    overflow: visible !important;
  }
  
  // Ensure SVG elements are full width and scrollable
  .recharts-surface svg {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important;
    min-width: 100% !important;
    height: 100% !important;
    overflow: visible !important;
  }
  
  // Make chart areas scrollable horizontally if needed
  .recharts-cartesian-grid,
  .recharts-cartesian-axis {
    width: 100% !important;
  }
  
  // Ensure chart content can scroll
  .jobs-overview-chart .recharts-wrapper,
  .weekly-postings-chart .recharts-wrapper {
    width: 100% !important;
    min-width: 100% !important;
    overflow: visible !important;
  }
  
  // Chart text sizes - make readable on mobile
  .chart-xaxis,
  .chart-yaxis {
    .recharts-text {
      font-size: 10px !important;
    }
  }
  
  // Chart legends - make compact on mobile
  .chart-legend {
    font-size: 10px !important;
    
    .recharts-legend-item {
      margin-right: 8px !important;
      margin-bottom: 4px !important;
    }
  }
  
  // Area chart specific adjustments
  .jobs-overview-area-chart {
    .recharts-surface {
      overflow: visible;
    }
  }
  
  // Reduce margins on mobile for more chart space
  .recharts-cartesian-axis {
    font-size: 10px !important;
  }
  
  // Tooltip adjustments
  .recharts-tooltip-wrapper {
    font-size: 11px !important;
  }
  
  // Card body padding adjustments for charts
  .jobs-overview-card .card-body,
  .weekly-postings-card .card-body {
    padding: 1rem 0.75rem !important;
  }
  
  // Make sure charts are not hidden - force all children visible
  .jobs-overview-chart,
  .weekly-postings-chart {
    > div {
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      height: 100% !important;
      width: 100% !important;
    }
    
    // Ensure all nested divs are visible
    div {
      display: block !important;
      visibility: visible !important;
    }
  }
  
  // Force chart rendering on mobile
  .jobs-overview-chart .recharts-wrapper,
  .weekly-postings-chart .recharts-wrapper {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
}

// Tablet adjustments (768px - 991px)
@media (min-width: 768px) and (max-width: 991.98px) {
  .table {
    font-size: 0.8rem;
    min-width: 1400px;
  }
  
  .modal {
    .modal-dialog {
      max-width: 90%;
      margin: 1rem auto;
      height: auto;
      max-height: 90vh;
    }
    
    .modal-content {
      height: auto;
      max-height: 90vh;
    }
  }
  
  // Buttons can be inline on tablet
  .btn-group {
    flex-direction: row;
    
    .btn {
      width: auto;
      margin-bottom: 0;
    }
  }
  
  .btn:not(.btn-link):not(.btn-ghost) {
    width: auto;
    margin-bottom: 0;
  }
}

// Small mobile (≤576px)
@media (max-width: 575.98px) {
  .table {
    font-size: 0.7rem !important;
    min-width: 1000px !important;
  }
  
  // Hide less important columns on very small screens
  .table th:nth-child(n+6),
  .table td:nth-child(n+6) {
    display: none;
  }
  
  // Show essential columns only
  .table th:nth-child(-n+5),
  .table td:nth-child(-n+5) {
    display: table-cell;
  }
  
  .table th:last-child,
  .table td:last-child {
    display: table-cell; // Always show Actions
  }
  
  // Ensure charts are visible on very small screens
  .jobs-overview-chart,
  .weekly-postings-chart {
    height: 350px !important;
    min-height: 350px !important;
  }
  
  .jobs-overview-card,
  .weekly-postings-card {
    min-height: 450px !important;
  }
  
  .jobs-overview-card .card-body,
  .weekly-postings-card .card-body {
    min-height: 400px !important;
  }
  
  .recharts-responsive-container {
    min-height: 300px !important;
    height: 100% !important;
  }
}

// Utility classes for responsive visibility
.d-mobile-none {
  @media (max-width: 767.98px) {
    display: none !important;
  }
}

.d-mobile-block {
  @media (max-width: 767.98px) {
    display: block !important;
  }
}

.d-desktop-none {
  @media (min-width: 768px) {
    display: none !important;
  }
}
